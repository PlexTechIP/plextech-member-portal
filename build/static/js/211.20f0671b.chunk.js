"use strict";(self.webpackChunkplexfinance=self.webpackChunkplexfinance||[]).push([[211],{6465:function(e,r,t){t.d(r,{A:function(){return c}});var n=t(94469),s=t(33604),i=t(4117),o=t(69099),a=(t(47313),t(46417));function c(e){return(0,a.jsxs)(n.Z,{onClose:e.onClose,open:e.open,PaperProps:{style:{borderRadius:"24px",padding:"24px"}},children:[(0,a.jsxs)(s.Z,{children:["Are you sure you want to delete this ",e.item,"?"]}),(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(o.Z,{onClick:e.onClose,children:"Cancel"}),(0,a.jsx)(o.Z,{onClick:e.onDelete,variant:"contained",children:"Delete"})]})]})}},95785:function(e,r,t){t.d(r,{C:function(){return x}});var n,s=t(30168),i=t(53115),o=t(42832),a=t(47131),c=t(70501),l=t(10387),d=(t(47313),t(96694)),u=t(32094),h=t.p+"static/media/error.062a662df0ebdd9a7227.png",p=t(46417);function x(e){return(0,p.jsx)(j,{open:e.open,children:(0,p.jsx)(f,{children:(0,p.jsxs)(o.Z,{spacing:2,children:[(0,p.jsxs)(o.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,p.jsxs)(Z,{children:["Error",e.error.errorCode&&" ".concat(e.error.errorCode),":"," ",e.error.errorMessage]}),(0,p.jsx)(a.Z,{onClick:function(){window.location.reload()},children:(0,p.jsx)(u.Z,{})})]}),(0,p.jsxs)(m,{children:["Try refreshing the page and contact"," ",(0,p.jsx)("a",{href:"mailto:shamith09@berkeley.edu?subject=[Plexfinance Error]",children:"shamith09@berkeley.edu"})," ","if the issue persists."]}),(0,p.jsx)("img",{src:h,alt:"error"})]})})})}var f=(0,d.Z)(c.Z)(n||(n=(0,s.Z)(["\n  padding: 48px;\n  border-radius: 48px;\n"]))),Z=i.ZP.h1.withConfig({componentId:"sc-khwwpk-0"})(["margin:0px;"]),m=i.ZP.p.withConfig({componentId:"sc-khwwpk-1"})(["margin:0px;"]),j=(0,i.ZP)(l.Z).withConfig({componentId:"sc-khwwpk-2"})(["width:50%;min-width:500px;height:100%;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;padding:64px;"])},86095:function(e,r,t){t.r(r),t.d(r,{AttendancePage:function(){return R}});var n=t(30168),s=t(93433),i=t(37762),o=t(74165),a=t(1413),c=t(15861),l=t(29439),d=t(53115),u=t(95785),h=t(47313),p=t(65964),x=t(10658),f=t.n(x),Z=t(83814),m=t(49124),j=t(43394),g=t(42832),k=t(31427),b=t(69099),v=t(41727),y=t(47131),w=t(51629),C=t(66835),S=t(23477),T=t(24076),M=t(67478),A=t(57861),D=t(70501),P=t(85281),z=t(96694),E=t(57829),Y=t(65033),I=t(61113),N=t(29428),_=t(3665),B=t(6465),O=t(35192),L=t(46417),J=3;function q(e){var r=e.user,t=e.date,n=e.setLoading,s=e.setError,i=(0,h.useState)(!1),a=(0,l.Z)(i,2),d=a[0],u=a[1],p=(0,h.useState)(!1),x=(0,l.Z)(p,2),Z=x[0],m=x[1],j=function(){var r=(0,c.Z)((0,o.Z)().mark((function r(t){var i,a;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return m(!1),n(!0),i="".concat("http://localhost:5001","/attendance/"),r.prev=3,r.next=6,fetch(i,{method:"DELETE",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({_id:t})});case 6:if(a=r.sent,n(!1),e.onDelete(t),401!==a.status&&422!==a.status){r.next=14;break}return e.removeToken(),r.abrupt("return");case 14:a.ok||(s({errorCode:a.status,errorMessage:a.statusText}),console.error(a));case 15:r.next=21;break;case 17:r.prev=17,r.t0=r.catch(3),s({errorMessage:r.t0.toString()}),console.error(r.t0);case 21:case"end":return r.stop()}}),r,null,[[3,17]])})));return function(e){return r.apply(this,arguments)}}(),k=function(){var t=(0,c.Z)((0,o.Z)().mark((function t(i,a){var c,l;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c="".concat("http://localhost:5001","/attendance/"),n(!0),t.prev=2,t.next=5,fetch(c,{method:"DELETE",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({_id:r._id,date:a,type:i})});case 5:if(l=t.sent,n(!1),"tardy"===i?(delete r.tardies[r.tardies.findIndex((function(e){return e.isSame(a,"day")}))],r.tardies=r.tardies.filter((function(e){return void 0!==e}))):"absent"===i?(delete r.absences[r.absences.findIndex((function(e){return e.isSame(a,"day")}))],r.absences=r.absences.filter((function(e){return void 0!==e}))):(delete r.strikes[r.strikes.findIndex((function(e){return e.isSame(a,"day")}))],r.strikes=r.strikes.filter((function(e){return void 0!==e}))),401!==l.status&&422!==l.status){t.next=13;break}return e.removeToken(),t.abrupt("return");case 13:l.ok||(s({errorCode:l.status,errorMessage:l.statusText}),console.error(l));case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(2),s({errorMessage:t.t0.toString()}),console.error(t.t0);case 20:case"end":return t.stop()}}),t,null,[[2,16]])})));return function(e,r){return t.apply(this,arguments)}}(),v=function(){var i=(0,c.Z)((0,o.Z)().mark((function i(a){var c,l;return(0,o.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c="".concat("http://localhost:5001","/attendance/"),n(!0),i.prev=2,i.next=5,fetch(c,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({_id:r._id,date:t,type:a})});case 5:if(l=i.sent,n(!1),"tardy"===a?r.tardies.push(t):"absent"===a?r.absences.push(t):r.strikes.push(t),401!==l.status&&422!==l.status){i.next=13;break}return e.removeToken(),i.abrupt("return");case 13:l.ok||(s({errorCode:l.status,errorMessage:l.statusText}),console.error(l));case 14:i.next=20;break;case 16:i.prev=16,i.t0=i.catch(2),s({errorMessage:i.t0.toString()}),console.error(i.t0);case 20:case"end":return i.stop()}}),i,null,[[2,16]])})));return function(e){return i.apply(this,arguments)}}();return(0,L.jsxs)(L.Fragment,{children:[Z&&(0,L.jsx)(B.A,{open:Z,item:"user",onClose:function(){return m(!1)},onDelete:function(){return j(r._id)}}),(0,L.jsxs)(T.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,L.jsx)(M.Z,{children:(0,L.jsx)(y.Z,{size:"small",onClick:function(){return u(!d)},style:{width:"10px",backgroundColor:"transparent"},disabled:!d&&r.absences.length+r.tardies.length===0,children:d?(0,L.jsx)(_.Z,{}):(0,L.jsx)(N.Z,{})})}),(0,L.jsx)(M.Z,{component:"th",scope:"row",children:r.registered?"".concat(r.firstName," ").concat(r.lastName):r.email}),(0,L.jsx)(M.Z,{align:"right",children:(0,L.jsx)(b.Z,{size:"small",onClick:function(){v("tardy")},children:r.tardies.length})}),(0,L.jsx)(M.Z,{align:"right",children:(0,L.jsx)(b.Z,{size:"small",onClick:function(){v("absent")},children:r.absences.length})}),(0,L.jsx)(M.Z,{align:"right",children:(0,L.jsx)(b.Z,{size:"small",onClick:function(){v("strike")},children:r.strikes.length})}),(0,L.jsx)(M.Z,{align:"center",children:(0,L.jsx)(y.Z,{size:"small",onClick:function(){return m(!0)},children:(0,L.jsx)(O.Z,{})})})]},r._id),(0,L.jsx)(T.Z,{children:(0,L.jsx)(M.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:(0,L.jsx)(Y.Z,{in:r.tardies.length+r.absences.length+r.strikes.length>0&&d,timeout:"auto",unmountOnExit:!0,children:(0,L.jsxs)(E.Z,{sx:{margin:1},children:[(0,L.jsxs)(g.Z,{direction:"row",justifyContent:"space-between",style:{width:"100%"},children:[(0,L.jsx)(I.Z,{variant:"subtitle1",gutterBottom:!0,component:"div",children:"History"}),(0,L.jsxs)(I.Z,{variant:"subtitle1",gutterBottom:!0,component:"div",children:["Slip meetings left:"," ",Math.max(0,J-r.tardies.length-r.absences.length-r.strikes.length)]})]}),(0,L.jsxs)(C.Z,{size:"small","aria-label":"purchases",children:[(0,L.jsx)(S.Z,{children:(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{children:"Date"}),(0,L.jsx)(M.Z,{children:"Tardy/Absence/Strike?"}),(0,L.jsx)(M.Z,{children:"Delete"})]})}),(0,L.jsx)(A.Z,{children:r.tardies.map((function(e){return(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{component:"th",scope:"row",children:f()(e).format("MM/DD/YYYY")}),(0,L.jsx)(M.Z,{children:"Tardy"}),(0,L.jsx)(M.Z,{children:(0,L.jsx)(y.Z,{onClick:function(){return k("tardy",e)},children:(0,L.jsx)(O.Z,{})})})]},e.toString())})).concat(r.absences.map((function(e){return(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{component:"th",scope:"row",children:f()(e).format("MM/DD/YYYY")}),(0,L.jsx)(M.Z,{children:"Absence"}),(0,L.jsx)(M.Z,{children:(0,L.jsx)(y.Z,{onClick:function(){return k("absent",e)},children:(0,L.jsx)(O.Z,{})})})]},e.toString())}))).concat(r.strikes.map((function(e){return(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{component:"th",scope:"row",children:f()(e).format("MM/DD/YYYY")}),(0,L.jsx)(M.Z,{children:"Strike"}),(0,L.jsx)(M.Z,{children:(0,L.jsx)(y.Z,{onClick:function(){return k("strike",e)},children:(0,L.jsx)(O.Z,{})})})]},e.toString())}))).sort()})]})]})})})})]})}var F,G,H=t(5211);function R(e){var r=(0,h.useState)(!1),t=(0,l.Z)(r,2),n=t[0],d=t[1],x=(0,h.useState)(),D=(0,l.Z)(x,2),P=D[0],z=D[1],E=(0,h.useState)([]),Y=(0,l.Z)(E,2),I=Y[0],N=Y[1],_=(0,h.useState)(f()()),B=(0,l.Z)(_,2),O=B[0],J=B[1],F=(0,h.useState)(""),G=(0,l.Z)(F,2),R=G[0],K=G[1],Q=(0,h.useState)(!1),V=(0,l.Z)(Q,2),X=V[0],ee=V[1];(0,h.useEffect)((function(){var r=function(){var r=(0,c.Z)((0,o.Z)().mark((function r(){var t,n,s;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return d(!0),t="".concat("http://localhost:5001","/attendance/"),r.prev=2,r.next=5,fetch(t,{method:"GET",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer"});case 5:if(n=r.sent,d(!1),401!==n.status&&422!==n.status){r.next=12;break}return e.removeToken(),r.abrupt("return");case 12:n.ok||(z({errorCode:n.status,errorMessage:n.statusText}),console.error(n));case 13:return r.next=15,n.json();case 15:s=r.sent,N(s.users.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{tardies:e.tardies.map((function(e){return f()(e)})),absences:e.absences.map((function(e){return f()(e)})),strikes:e.strikes.map((function(e){return f()(e)}))})}))),r.next=23;break;case 19:r.prev=19,r.t0=r.catch(2),z({errorMessage:r.t0.toString()}),console.error(r.t0);case 23:case"end":return r.stop()}}),r,null,[[2,19]])})));return function(){return r.apply(this,arguments)}}();r()}),[e,e.token]);var re=function(e){N(I.filter((function(r){return r._id!==e})))},te=function(){var r=(0,c.Z)((0,o.Z)().mark((function r(){var t,n,a,c,l,u,h;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:d(!0),t=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,n=(0,i.Z)(R.split(", ")),r.prev=3,n.s();case 5:if((a=n.n()).done){r.next=13;break}if(c=a.value,t.test(c)){r.next=11;break}return ee(!0),d(!1),r.abrupt("return");case 11:r.next=5;break;case 13:r.next=18;break;case 15:r.prev=15,r.t0=r.catch(3),n.e(r.t0);case 18:return r.prev=18,n.f(),r.finish(18);case 21:return l="".concat("http://localhost:5001","/profile/"),r.prev=22,r.next=25,fetch(l,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({emails:R.split(", ")})});case 25:if(401!==(u=r.sent).status&&422!==u.status){r.next=31;break}return e.removeToken(),r.abrupt("return");case 31:u.ok||(z({errorCode:u.status,errorMessage:u.statusText}),console.error(u));case 32:return r.next=34,u.json();case 34:h=r.sent,N([].concat((0,s.Z)(I),(0,s.Z)(h.users))),d(!1),K(""),r.next=44;break;case 40:r.prev=40,r.t1=r.catch(22),z({errorMessage:r.t1.toString()}),console.error(r.t1);case 44:case"end":return r.stop()}}),r,null,[[3,15,18,21],[22,40]])})));return function(){return r.apply(this,arguments)}}();return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(p.ql,{children:[(0,L.jsx)("title",{children:"Attendance"}),(0,L.jsx)("meta",{name:"description",content:"Take attendance here"})]}),P&&(0,L.jsx)(u.C,{open:!!P,error:P}),(0,L.jsx)($,{children:(0,L.jsxs)(g.Z,{spacing:4,children:[(0,L.jsxs)(j._,{dateAdapter:m.y,children:[(0,L.jsxs)(U,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,L.jsx)(Z.M,{label:"GM Date",value:O,onChange:function(e){J(e)},renderInput:function(e){return(0,L.jsx)(k.Z,(0,a.Z)({},e))}}),n?(0,L.jsx)(W,{}):(0,L.jsx)(b.Z,{onClick:function(){console.log({tardy:I.filter((function(e){return e.tardies.filter((function(e){return e.isSame(O,"day")})).length>0})).map((function(e){return e.registered?"".concat(e.firstName," ").concat(e.lastName):e.email})),absent:I.filter((function(e){return e.absences.filter((function(e){return e.isSame(O,"day")})).length>0})).map((function(e){return e.registered?"".concat(e.firstName," ").concat(e.lastName):e.email}))})},variant:"contained",children:"Log Report"})]}),(0,L.jsx)(k.Z,{label:"Add User(s)",helperText:"Enter emails as a comma-separated list with spaces.",value:R,onChange:function(e){return K(e.target.value)},error:X,fullWidth:!0,InputProps:{endAdornment:(0,L.jsx)(v.Z,{position:"end",children:(0,L.jsx)(y.Z,{onClick:te,edge:"end",children:(0,L.jsx)(H.Z,{})})})}})]}),O&&(0,L.jsx)(w.Z,{children:(0,L.jsxs)(C.Z,{stickyHeader:!0,children:[(0,L.jsx)(S.Z,{children:(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{}),(0,L.jsx)(M.Z,{children:"Name"}),(0,L.jsx)(M.Z,{align:"right",children:"Tardies"}),(0,L.jsx)(M.Z,{align:"right",children:"Absences"}),(0,L.jsx)(M.Z,{align:"right",children:"Strikes"}),(0,L.jsx)(M.Z,{align:"center",children:"Delete"})]})}),(0,L.jsx)(A.Z,{children:I.map((function(r){return(0,L.jsx)(q,{user:r,date:O,token:e.token,removeToken:e.removeToken,setLoading:d,setError:z,onDelete:re},r._id)}))})]})})]})})]})}var $=(0,z.Z)(D.Z)(F||(F=(0,n.Z)(["\n  min-height: 95%;\n  width: 60%;\n  min-width: 500px;\n  margin: auto;\n  padding: 64px;\n  border-radius: 48px;\n"]))),U=(0,d.ZP)(g.Z).withConfig({componentId:"sc-1c0zhqi-0"})(["width:100%;"]),W=(0,z.Z)(P.Z)(G||(G=(0,n.Z)(["\n  color: rgb(255, 138, 0);\n"])))}}]);