"use strict";(self.webpackChunkplexfinance=self.webpackChunkplexfinance||[]).push([[953],{17762:function(e,n,t){t.d(n,{E:function(){return c}});var r=t(31427),o=t(41727),i=t(47131),s=(t(47313),t(83965)),a=t(46417);function c(e){return(0,a.jsx)("form",{style:{width:"100%"},children:(0,a.jsx)(r.Z,{variant:"outlined",onChange:function(n){return e.onChange(n.target.value)},value:e.comment,label:e.message,fullWidth:!0,InputProps:{endAdornment:(0,a.jsx)(o.Z,{position:"end",children:(0,a.jsx)(i.Z,{onClick:e.onSubmit,type:"submit",children:(0,a.jsx)(s.Z,{})})})}})})}},6465:function(e,n,t){t.d(n,{A:function(){return c}});var r=t(94469),o=t(33604),i=t(4117),s=t(69099),a=(t(47313),t(46417));function c(e){return(0,a.jsxs)(r.Z,{onClose:e.onClose,open:e.open,PaperProps:{style:{borderRadius:"24px",padding:"24px"}},children:[(0,a.jsxs)(o.Z,{children:["Are you sure you want to delete this ",e.item,"?"]}),(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(s.Z,{onClick:e.onClose,children:"Cancel"}),(0,a.jsx)(s.Z,{onClick:e.onDelete,variant:"contained",children:"Delete"})]})]})}},95785:function(e,n,t){t.d(n,{C:function(){return h}});var r,o=t(30168),i=t(53115),s=t(42832),a=t(47131),c=t(70501),u=t(10387),d=(t(47313),t(96694)),l=t(32094),p=t.p+"static/media/error.062a662df0ebdd9a7227.png",m=t(46417);function h(e){return(0,m.jsx)(g,{open:e.open,children:(0,m.jsx)(f,{children:(0,m.jsxs)(s.Z,{spacing:2,children:[(0,m.jsxs)(s.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,m.jsxs)(x,{children:["Error",e.error.errorCode&&" ".concat(e.error.errorCode),":"," ",e.error.errorMessage]}),(0,m.jsx)(a.Z,{onClick:function(){window.location.reload()},children:(0,m.jsx)(l.Z,{})})]}),(0,m.jsxs)(Z,{children:["Try refreshing the page and contact"," ",(0,m.jsx)("a",{href:"mailto:shamith09@berkeley.edu?subject=[Plexfinance Error]",children:"shamith09@berkeley.edu"})," ","if the issue persists."]}),(0,m.jsx)("img",{src:p,alt:"error"})]})})})}var f=(0,d.Z)(c.Z)(r||(r=(0,o.Z)(["\n  padding: 48px;\n  border-radius: 48px;\n"]))),x=i.ZP.h1.withConfig({componentId:"sc-khwwpk-0"})(["margin:0px;"]),Z=i.ZP.p.withConfig({componentId:"sc-khwwpk-1"})(["margin:0px;"]),g=(0,i.ZP)(u.Z).withConfig({componentId:"sc-khwwpk-2"})(["width:50%;min-width:500px;height:100%;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;padding:64px;"])},62704:function(e,n,t){t.r(n),t.d(n,{HomePage:function(){return Ke}});var r,o,i,s,a=t(30168),c=t(93433),u=t(1413),d=t(74165),l=t(15861),p=t(29439),m=t(47313),h=t(65964),f=t(53115),x=t(42832),Z=t(10387),g=t(85281),j=t(4942),w=t(69099),b=t(70501),v=t(96694),C=t(19860),k=t(73428),y=t(65954),q=t(54572),I=t(91210),S=t(47131),P=t(73984),E=t(56854),N=t(11198),R=t(47196),_=t(46417);function T(e){return(0,_.jsx)(B,{open:e.open,onClose:e.onClose,children:(0,_.jsxs)(U,{children:[(0,_.jsxs)(F,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,_.jsxs)(J,{children:["Receipts for ",e.itemDescription]}),(0,_.jsx)(S.Z,{onClick:e.onClose,children:(0,_.jsx)(N.Z,{})})]}),e.loading?(0,_.jsx)(L,{}):(0,_.jsx)(_.Fragment,{children:e.images&&(0,_.jsx)(P.Z,{cols:3,rowHeight:300,style:{height:"100%"},children:e.images.map((function(e){return(0,_.jsx)(E.Z,{cols:1,children:(0,_.jsx)("a",{download:e.name,href:e.data,children:(0,_.jsx)(O,{src:e.data,alt:"receipt",loading:"lazy"})})},e.name)}))})}),(0,_.jsx)(M,{children:(0,_.jsxs)(x.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,_.jsx)(z,{}),(0,_.jsx)(D,{children:"Click on an image to download it."})]})})]})})}var A,D=f.ZP.p.withConfig({componentId:"sc-1efhdpd-0"})(["color:grey;margin:0px;"]),z=(0,v.Z)(R.Z)(r||(r=(0,a.Z)(["\n  color: grey;\n  font-size: small;\n"]))),B=(0,f.ZP)(Z.Z).withConfig({componentId:"sc-1efhdpd-1"})(["width:50%;height:100%;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;padding:64px;"]),F=(0,v.Z)(x.Z)(o||(o=(0,a.Z)(["\n  width: 100%;\n  margin-bottom: 24px;\n"]))),M=f.ZP.div.withConfig({componentId:"sc-1efhdpd-2"})(["position:absolute;bottom:108px;"]),O=f.ZP.img.withConfig({componentId:"sc-1efhdpd-3"})(["max-width:100%;max-height:100%;filter:brightness(100%);-webkit-filter:brightness(100%);&:hover{filter:brightness(75%);-webkit-filter:brightness(75%);}-webkit-transition:all 0.25s ease;-moz-transition:all 0.25s ease;-o-transition:all 0.25s ease;-ms-transition:all 0.25s ease;transition:all 0.25s ease;"]),U=(0,v.Z)(b.Z)(i||(i=(0,a.Z)(["\n  padding: 48px;\n  border-radius: 48px;\n  height: 100%;\n"]))),J=f.ZP.h1.withConfig({componentId:"sc-1efhdpd-4"})(["margin:0px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;"]),L=(0,v.Z)(g.Z)(s||(s=(0,a.Z)(["\n  color: rgb(255, 138, 0);\n"]))),$=t(70022),Y=t(95785);function H(e){var n=(0,m.useState)(!1),t=(0,p.Z)(n,2),r=t[0],o=t[1],i=(0,m.useState)([]),s=(0,p.Z)(i,2),a=s[0],c=s[1],h=(0,m.useState)(),f=(0,p.Z)(h,2),Z=f[0],g=f[1],j=(0,m.useState)(!1),b=(0,p.Z)(j,2),v=b[0],k=b[1],S=function(){o(!1)},P=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(){var t,r,i;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return k(!0),o(!0),t="".concat("https://plexfinance-backend-production.up.railway.app","/requests/"),n.next=5,fetch(t,{method:"PUT",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({images:!0,request_id:e.request._id})});case 5:return r=n.sent,n.next=8,r.json();case 8:i=n.sent,r.ok||g({errorCode:r.status,errorMessage:r.statusText}),c(i.images),k(!1);case 12:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),E=(0,C.Z)();return(0,_.jsx)($._l,{draggableId:e.request._id,index:e.index,children:function(n){return(0,_.jsxs)(G,(0,u.Z)((0,u.Z)((0,u.Z)({elevation:2},n.draggableProps),n.dragHandleProps),{},{ref:n.innerRef,children:[Z&&(0,_.jsx)(Y.C,{open:!!Z,error:Z}),r&&(0,_.jsx)(T,{images:a,onClose:S,open:r,itemDescription:e.request.itemDescription,loading:v}),(0,_.jsxs)(x.Z,{spacing:1,children:[(0,_.jsxs)(W,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,_.jsx)(K,{children:e.request.itemDescription}),(0,_.jsxs)(K,{style:{flexShrink:0,paddingLeft:"8px"},children:["$",e.request.amount.toFixed(2)]})]}),(0,_.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.mine?(0,_.jsx)(w.Z,{size:"small",startIcon:m.cloneElement((0,_.jsx)(q.Z,{})),onClick:P,style:{color:E.palette.text.primary},children:"Receipt(s)"}):(0,_.jsx)(Q,{children:e.request.firstName}),(0,_.jsx)(w.Z,{style:{color:E.palette.text.primary,zIndex:999},size:"small",startIcon:m.cloneElement(e.mine?(0,_.jsx)(y.Z,{}):(0,_.jsx)(I.Z,{})),onClick:function(){return e.onEdit(e.mine)},disabled:!1,children:e.mine?"Edit":"View"})]})]})]}),e.request._id)}})}var V,G=(0,v.Z)(k.Z)(A||(A=(0,a.Z)(["\n  padding: 16px;\n  text-align: left;\n  display: flex;\n  flex-direction: column;\n  border-radius: 16px;\n  width: 100%;\n"]))),K=f.ZP.h3.withConfig({componentId:"sc-o7ze2-0"})(["margin:0px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;"]),W=(0,f.ZP)(x.Z).withConfig({componentId:"sc-o7ze2-1"})(["width:100%;"]),Q=f.ZP.p.withConfig({componentId:"sc-o7ze2-2"})(["margin:0;overflow:hidden;"]),X=t(5211),ee=t(7861),ne=t(19536),te=t(41727),re=t(84031),oe=t(31427),ie=t(17762);function se(e){var n=e.id,t=e.comment;return(0,_.jsxs)(ce,{style:{alignSelf:n===t.user_id?"flex-end":"flex-start",borderBottomLeftRadius:n===t.user_id?"24px":"0",borderBottomRightRadius:n===t.user_id?"0":"24px"},children:[(0,_.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,_.jsxs)(ue,{children:[t.firstName," ",t.lastName]}),(0,_.jsx)(ue,{children:t.date.format("MM/DD/YYYY")})]}),(0,_.jsx)(de,{children:t.message})]})}var ae,ce=(0,v.Z)(k.Z)(V||(V=(0,a.Z)(["\n  width: 50%;\n  padding: 16px;\n  border-top-right-radius: 24px;\n  border-top-left-radius: 24px;\n"]))),ue=f.ZP.h4.withConfig({componentId:"sc-jv27uf-0"})(["margin:0;"]),de=f.ZP.p.withConfig({componentId:"sc-jv27uf-1"})(["margin:0;color:grey;"]),le=t(10658),pe=t.n(le);function me(e){var n=(0,m.useState)(0),t=(0,p.Z)(n,2),r=t[0],o=t[1];(0,m.useEffect)((function(){o(e.requestedAmount)}),[e.requestedAmount]);var i=(0,m.useState)([]),s=(0,p.Z)(i,2),a=s[0],u=s[1],d=(0,m.useState)(""),l=(0,p.Z)(d,2),h=l[0],f=l[1];return(0,_.jsx)(xe,{open:e.open,onClose:e.onClose,children:(0,_.jsx)(Ze,{children:(0,_.jsxs)(x.Z,{spacing:3,children:[(0,_.jsx)(ge,{children:"Reimbursement Request Approval"}),(0,_.jsx)(ne.Z,{}),(0,_.jsx)(je,{children:"How much do you want to approve this request for?"}),(0,_.jsxs)(x.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,_.jsx)(fe,{variant:"outlined",type:"number",value:r,label:"Amount",InputProps:{startAdornment:(0,_.jsx)(te.Z,{position:"start",children:"$"})},required:!0,onChange:function(e){var n=e.target;return o(n.value)}}),(0,_.jsx)(w.Z,{variant:"text",onClick:function(){return o(e.requestedAmount)},children:"Reset"})]}),(0,_.jsx)(re.ZP,{defaultValue:100,value:Math.round(r/e.requestedAmount*100),step:5,min:0,max:100,onChange:function(n){var t=n.target;return o(+(e.requestedAmount/100*t.value).toFixed(2))},valueLabelDisplay:"auto",marks:[{value:0,label:"0%"},{value:50,label:"50%"},{value:100,label:"100%"}],style:{marginLeft:"8px",marginRight:"8px",marginBottom:"24px"}}),(0,_.jsx)(ne.Z,{}),[].concat((0,c.Z)(a),[{message:"Request approved for $".concat(r," (").concat(Math.round(r/e.requestedAmount*100),"%)"),date:pe()(),user_id:(0,ee.Z)(e.token).sub,firstName:e.userName.firstName,lastName:e.userName.lastName}]).map((function(n,t){return(0,_.jsx)(se,{id:(0,ee.Z)(e.token).sub,comment:n},t)})).sort(),(0,_.jsx)(ie.E,{comment:h,message:"Add Comment",onChange:function(e){return f(e)},onSubmit:function(n){n.preventDefault(),u((function(n){return[].concat((0,c.Z)(n),[{message:h,date:pe()(),user_id:(0,ee.Z)(e.token).sub,firstName:e.userName.firstName,lastName:e.userName.lastName}])}))}}),(0,_.jsxs)(we,{direction:"row",justifyContent:"space-between",children:[(0,_.jsx)(w.Z,{variant:"contained",onClick:function(){return e.onSubmit(a,r)},type:"submit",children:"Approve"}),(0,_.jsx)(w.Z,{variant:"contained",onClick:function(){e.onClose()},children:"Cancel"})]})]})})})}var he,fe=(0,f.ZP)(oe.Z).withConfig({componentId:"sc-ckh0d9-0"})(["width:40%;"]),xe=(0,f.ZP)(Z.Z).withConfig({componentId:"sc-ckh0d9-1"})(["width:50%;height:100%;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;padding:64px;"]),Ze=(0,v.Z)(b.Z)(ae||(ae=(0,a.Z)(["\n  padding: 48px;\n  border-radius: 48px;\n  height: 100%;\n"]))),ge=f.ZP.h1.withConfig({componentId:"sc-ckh0d9-2"})(["margin:0px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;"]),je=f.ZP.h3.withConfig({componentId:"sc-ckh0d9-3"})(["margin:0px;"]),we=(0,f.ZP)(x.Z).withConfig({componentId:"sc-ckh0d9-4"})(["width:100%;"]),be=["pendingReview","underReview","errors","approved","declined"];function ve(e){var n=(0,m.useState)({pendingReview:0,underReview:0,errors:0,approved:0,declined:0}),t=(0,p.Z)(n,2),r=t[0],o=t[1],i=(0,m.useState)(),s=(0,p.Z)(i,2),a=s[0],c=s[1],h=(0,m.useState)(!1),f=(0,p.Z)(h,2),Z=f[0],g=f[1],b=(0,m.useState)(0),v=(0,p.Z)(b,2),C=v[0],k=v[1],y=(0,m.useState)(""),q=(0,p.Z)(y,2),I=q[0],S=q[1],P=(0,m.useState)(""),E=(0,p.Z)(P,2),N=E[0],R=E[1],T=(0,m.useState)(0),A=(0,p.Z)(T,2),D=A[0],z=A[1],B=(0,m.useState)(0),F=(0,p.Z)(B,2),M=F[0],O=F[1];(0,m.useEffect)((function(){var n={pendingReview:0,underReview:0,errors:0,approved:0,declined:0};e.requests&&(be.forEach((function(t){e.requests[t].forEach((function(e){n[t]+=e.amount}))})),o(n))}),[e.requests]);var U=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(t){var r,i,s,a,l;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.destination,i=t.source,null!==r&&r.droppableId!==i.droppableId&&e.isTreasurer){n.next=3;break}return n.abrupt("return");case 3:if(s=e.requests[i.droppableId][i.index],"approved"!==r.droppableId){n.next=12;break}return g(!0),k(s.amount),S(s._id),R(i.droppableId),z(i.index),O(r.index),n.abrupt("return");case 12:return e.requests[i.droppableId].splice(i.index,1),e.requests[r.droppableId].splice(r.index,0,s),o((function(e){var n;return(0,u.Z)((0,u.Z)({},e),{},(n={},(0,j.Z)(n,i.droppableId,e[i.droppableId]-s.amount),(0,j.Z)(n,r.droppableId,e[r.droppableId]+s.amount),n))})),n.prev=15,a="".concat("https://plexfinance-backend-production.up.railway.app","/approval/").concat(s._id,"/"),n.next=19,fetch(a,{method:"PUT",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({status:r.droppableId,comments:[]})});case 19:(l=n.sent).ok||(c({errorCode:l.status,errorMessage:l.statusText}),console.error(l)),n.next=27;break;case 23:n.prev=23,n.t0=n.catch(15),console.error(n.t0),c({errorMessage:n.t0.toString()});case 27:case"end":return n.stop()}}),n,null,[[15,23]])})));return function(e){return n.apply(this,arguments)}}(),J=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(t,r){var i,s,a;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i="".concat("https://plexfinance-backend-production.up.railway.app","/approval/").concat(I,"/"),n.next=4,fetch(i,{method:"PUT",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({status:"approved",comments:t,amount:r})});case 4:407===(s=n.sent).status&&c({errorMessage:"No Venmo ID found."}),s.ok||(c({errorCode:s.status,errorMessage:s.statusText}),console.error(s)),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.error(n.t0),c({errorMessage:n.t0.toString()});case 13:a=e.requests[N].splice(D,1)[0],e.requests.approved.splice(M,0,a),o((function(e){var n;return(0,u.Z)((0,u.Z)({},e),{},(n={},(0,j.Z)(n,N,e[N]-a.amount),(0,j.Z)(n,"approved",e.approved+r),n))})),g(!1);case 17:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}();return(0,_.jsxs)(_.Fragment,{children:[a&&(0,_.jsx)(Y.C,{open:!!a,error:a}),(0,_.jsx)(me,{open:Z,onClose:function(){return g(!1)},requestedAmount:C,onSubmit:J,token:e.token,userName:e.userName}),(0,_.jsx)($.Z5,{onDragEnd:U,children:(0,_.jsx)(x.Z,{direction:"row",spacing:1,children:be.map((function(n){var t=n.replace(/([A-Z])/g," $1"),o=t.charAt(0).toUpperCase()+t.slice(1);return(0,_.jsxs)(ye,{children:[e.requests&&0!==e.requests[n].length?(0,_.jsxs)(qe,{children:[o,": $",r[n].toFixed(2)]}):(0,_.jsx)(qe,{children:o}),(0,_.jsxs)(x.Z,{spacing:1,children:["pendingReview"===n&&null!==e.requests&&(0,_.jsx)(w.Z,{startIcon:m.cloneElement((0,_.jsx)(X.Z,{})),onClick:e.onRequest,children:"Request Reimbursement"}),(0,_.jsx)($.bK,{droppableId:n,children:function(t){return(0,_.jsxs)(x.Z,(0,u.Z)((0,u.Z)({spacing:1,ref:t.innerRef},t.droppableProps),{},{children:[e.requests&&e.requests[n].sort((function(e,n){return n.amount-e.amount})).map((function(n,t){return(0,_.jsx)(H,{token:e.token,request:n,index:t,onEdit:function(t){return e.onEdit(n,t)},mine:!e.isTreasurer||n.user_id===(0,ee.Z)(e.token).sub},n._id)})),t.placeholder]}))}})]})]},n)}))})})]})}var Ce,ke,ye=(0,v.Z)(b.Z)(he||(he=(0,a.Z)(["\n  width: calc(20% - 8px);\n  height: 100%;\n  padding: 32px;\n  text-align: center;\n  border-radius: 24px;\n"]))),qe=f.ZP.h2.withConfig({componentId:"sc-9v3hzi-0"})(["margin:0px;padding-bottom:16px;"]),Ie=t(1550),Se=t(5178),Pe=t(55685),Ee=t(83929),Ne=t(74268),Re=t(44758),_e=t(51997),Te=t(26719),Ae=t.n(Te),De=t(6465),ze={itemDescription:"",amount:"",teamBudget:"No budget",isFood:!1,images:[],status:"pendingReview",comments:[]};function Be(e){var n,t=(0,m.useState)(ze),r=(0,p.Z)(t,2),o=r[0],i=r[1],s=(0,m.useState)(!1),a=(0,p.Z)(s,2),h=a[0],f=a[1],Z=(0,m.useState)(!1),g=(0,p.Z)(Z,2),j=g[0],b=g[1],v=(0,m.useState)(!1),C=(0,p.Z)(v,2),k=C[0],y=C[1],I=(0,m.useState)(!1),P=(0,p.Z)(I,2),E=P[0],R=P[1],A=(0,m.useState)(!1),D=(0,p.Z)(A,2),z=D[0],B=D[1],F=(0,m.useState)(""),M=(0,p.Z)(F,2),O=M[0],U=M[1],J=(0,m.useState)([]),L=(0,p.Z)(J,2),$=L[0],Y=L[1],H=(0,m.useState)(!1),V=(0,p.Z)(H,2),G=V[0],K=V[1];(0,m.useEffect)((function(){if(e.request){var n=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(){var t,r,o;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return K(!0),t="".concat("https://plexfinance-backend-production.up.railway.app","/requests/"),n.next=4,fetch(t,{method:"PUT",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({comment:!0,request_id:e.request?e.request._id:null})});case 4:return r=n.sent,n.next=7,r.json();case 7:return o=n.sent,r.ok||e.onError(r),K(!1),i((0,u.Z)((0,u.Z)({},e.request),{},{amount:e.request.amount.toString(),comments:o.comments.map((function(e){return(0,u.Z)((0,u.Z)({},e),{},{date:pe()(e.date)})})),images:[]})),n.next=13,de();case 13:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}else W()}),[]);var W=function(){i((0,u.Z)((0,u.Z)({},ze),{},{comments:[]}))},Q=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(t){var r;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.target.files[0]){n.next=2;break}return n.abrupt("return");case 2:R(!0),(r=(0,c.Z)(t.target.files)).forEach((function(n,t){"application/pdf"!==n.type?new(Ae())(n,{quality:.2,success:function(e){i((function(n){return(0,u.Z)((0,u.Z)({},n),{},{images:[].concat((0,c.Z)(n.images),[{name:e.name,data:e,isBase64:!1}])})})),t===r.length-1&&R(!1)},error:function(n){e.onError({status:null,statusText:"Image compression failed"})}}):i((function(e){return(0,u.Z)((0,u.Z)({},e),{},{images:[].concat((0,c.Z)(e.images),[{name:n.name,data:n,isBase64:!1}])})}))})),R(!1);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),X=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(){var t;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return y(!1),t="".concat("https://plexfinance-backend-production.up.railway.app","/requests/"),n.next=4,fetch(t,{method:"DELETE",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({_id:e.request._id})});case 4:e.onClose(),e.onSubmit(e.request,!0);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),re=function(e){return new Promise((function(n){var t="",r=new FileReader;r.readAsDataURL(e),r.onload=function(){t=r.result,n(t)}}))},ae=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(t){var r,i,s,a;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.preventDefault(),!j&&""!==o.amount&&""!==o.itemDescription&&0!==o.images.length&&!E){n.next=4;break}return f(!0),n.abrupt("return");case 4:return b(!0),n.t0=u.Z,n.t1=(0,u.Z)({},o),n.t2={},n.next=10,Promise.all(o.images.map(function(){var e=(0,l.Z)((0,d.Z)().mark((function e(n){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.isBase64){e.next=8;break}return e.t1=n.name,e.next=4,re(n.data);case 4:e.t2=e.sent,e.t0={name:e.t1,data:e.t2,isBase64:!0},e.next=9;break;case 8:e.t0=n;case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 10:return n.t3=n.sent,n.t4=parseFloat(o.amount),n.t5={images:n.t3,amount:n.t4},r=(0,n.t0)(n.t1,n.t2,n.t5),i="".concat("https://plexfinance-backend-production.up.railway.app","/requests/"),n.next=17,fetch(i,{method:e.request?"PUT":"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify((0,u.Z)((0,u.Z)((0,u.Z)({},r),{},{date:pe()()},e.userName),{},{request_id:e.request?e.request._id:null}))});case 17:return(s=n.sent).ok||e.onError(s),n.next=21,s.json();case 21:a=n.sent,W(),f(!1),e.onClose(),e.onSubmit((0,u.Z)((0,u.Z)({},r),{},{_id:e.request?e.request._id:a._id,comments:[],date:pe()(),user_id:e.request?e.request.user_id:(0,ee.Z)(e.token).sub})),b(!1);case 27:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),ce=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(t){var r,i;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.preventDefault(),""!==O){n.next=3;break}return n.abrupt("return");case 3:if(r={message:O,date:pe()(),user_id:(0,ee.Z)(e.token).sub,firstName:e.userName.firstName,lastName:e.userName.lastName},o.comments.push(r),!e.request){n.next=9;break}return i="".concat("https://plexfinance-backend-production.up.railway.app","/requests/"),n.next=9,fetch(i,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({comment:r,request_id:e.request._id})});case 9:U("");case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),ue=function(){var e=(0,l.Z)((0,d.Z)().mark((function e(){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!0),B(!0),e.next=4,de();case 4:K(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(){var t,r,o,i;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r="".concat("https://plexfinance-backend-production.up.railway.app","/requests/"),n.next=3,fetch(r,{method:"PUT",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({images:!0,request_id:null===(t=e.request)||void 0===t?void 0:t._id})});case 3:return o=n.sent,n.next=6,o.json();case 6:if(i=n.sent,o.ok){n.next=10;break}return e.onError(o),n.abrupt("return");case 10:Y(i.images);case 11:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,_.jsxs)(Ue,{elevation:3,children:[(0,_.jsx)(De.A,{open:k,onClose:function(){return y(!1)},onDelete:X,item:"request"}),(0,_.jsx)(T,{loading:G,open:z,onClose:function(){return B(!1)},images:$,itemDescription:null===(n=e.request)||void 0===n?void 0:n.itemDescription}),(0,_.jsxs)(Je,{direction:"row",justifyContent:"space-between",alignItems:"center",style:{marginBottom:"16px"},children:[(0,_.jsx)($e,{children:"Reimbursement Request Form"}),e.canEdit&&e.request?(0,_.jsx)(S.Z,{onClick:function(){y(!0)},children:(0,_.jsx)(_e.Z,{fontSize:"large"})}):(0,_.jsx)(Ye,{children:"* = required"})]}),(0,_.jsx)("form",{children:(0,_.jsxs)(x.Z,{spacing:3,alignItems:"flex-start",children:[(0,_.jsx)(He,{variant:"outlined",onChange:function(e){var n=e.target;return i((function(e){return(0,u.Z)((0,u.Z)({},e),{},{itemDescription:n.value})}))},value:o.itemDescription,label:"Item Description",required:!0,error:h&&""===o.itemDescription,helperText:h&&""===o.itemDescription&&"Required",disabled:!e.canEdit}),(0,_.jsxs)(x.Z,{direction:"row",spacing:3,alignItems:"center",children:[(0,_.jsx)(oe.Z,{variant:"outlined",onChange:function(e){var n=e.target;return i((function(e){return(0,u.Z)((0,u.Z)({},e),{},{amount:n.value})}))},type:"number",value:o.amount,label:"Amount",InputProps:{startAdornment:(0,_.jsx)(te.Z,{position:"start",children:"$"})},required:!0,error:h&&""===o.amount,helperText:h&&""===o.amount&&"Required",disabled:!e.canEdit}),G&&(0,_.jsx)(Ve,{})]}),(0,_.jsx)(ne.Z,{}),(0,_.jsxs)(Ie.Z,{children:[(0,_.jsx)(Se.Z,{disabled:!e.canEdit,children:"Team Budget?"}),(0,_.jsxs)(Pe.Z,{row:!0,"aria-labelledby":"demo-row-radio-buttons-group-label",name:"row-radio-buttons-group",defaultValue:"No budget",onChange:function(e){var n=e.target;i((function(e){return(0,u.Z)((0,u.Z)({},e),{},{teamBudget:n.value})}))},children:[(0,_.jsx)(Ee.Z,{value:"No budget",control:(0,_.jsx)(Ne.Z,{disabled:!e.canEdit}),label:"No budget"}),(0,_.jsx)(Ee.Z,{value:"NMEP",control:(0,_.jsx)(Ne.Z,{disabled:!e.canEdit}),label:"NMEP"}),e.teams.map((function(n){return(0,_.jsx)(Ee.Z,{value:n,control:(0,_.jsx)(Ne.Z,{disabled:!e.canEdit}),label:n,disabled:!e.canEdit},n)}))]})]}),"No budget"!==o.teamBudget&&(0,_.jsxs)(x.Z,{spacing:1,direction:"row",alignItems:"center",children:[(0,_.jsx)(Se.Z,{disabled:!e.canEdit,children:"Food?"}),(0,_.jsx)(Re.Z,{disabled:!e.canEdit,checked:o.isFood,onChange:function(){i((function(e){return(0,u.Z)((0,u.Z)({},e),{},{isFood:!e.isFood})}))}})]}),(0,_.jsx)(Le,{variant:"middle",light:!0}),(0,_.jsxs)(x.Z,{spacing:1,alignItems:"flex-start",children:[e.canEdit?(0,_.jsxs)(w.Z,{variant:"contained",component:"label",style:{color:h&&0===o.images.length?"red":"rgb(255, 138, 0)"},startIcon:m.cloneElement((0,_.jsx)(q.Z,{})),children:[E?(0,_.jsx)(Ve,{size:20}):"Upload Receipt(s) *",(0,_.jsx)("input",{accept:"image/*,application/pdf",onChange:Q,type:"file",multiple:!0,hidden:!0})]}):(0,_.jsx)(w.Z,{variant:"contained",startIcon:m.cloneElement((0,_.jsx)(q.Z,{})),onClick:ue,children:"Receipt(s)"}),(0,_.jsx)(ne.Z,{}),e.canEdit&&[].concat((0,c.Z)($),(0,c.Z)(o.images)).map((function(e,n){return(0,_.jsxs)(x.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,_.jsx)(q.Z,{}),(0,_.jsx)("p",{children:e.name.length>20?"".concat(e.name.substring(0,20),"..."):e.name}),(0,_.jsx)(S.Z,{onClick:function(){return function(e){i((function(n){return(0,u.Z)((0,u.Z)({},n),{},{images:n.images.filter((function(n,t){return t!==e}))})}))}(n)},children:(0,_.jsx)(N.Z,{})})]},n)}))]}),(0,_.jsx)(Le,{variant:"middle",light:!0}),0===o.comments.length||(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Ge,{children:"Comments"}),o.comments.map((function(n){return(0,_.jsx)(se,{id:(0,ee.Z)(e.token).sub,comment:n},n.date.toString())})).sort(),(0,_.jsx)(Le,{variant:"middle",light:!0})]}),(0,_.jsx)(ie.E,{comment:O,onChange:U,onSubmit:ce,message:"Add Comment (optional)"}),(0,_.jsxs)(Je,{direction:"row",justifyContent:"space-between",children:[(0,_.jsxs)(x.Z,{spacing:1,direction:"row",children:[(0,_.jsx)(w.Z,{variant:"contained",onClick:ae,type:"submit",disabled:!e.canEdit,children:j?(0,_.jsx)(Ve,{size:20}):"Submit"}),(0,_.jsx)(w.Z,{variant:"contained",onClick:W,disabled:!e.canEdit,children:"Reset"})]}),(0,_.jsx)(w.Z,{variant:"contained",onClick:function(){W(),e.onClose()},children:"Cancel"})]})]})})]})}var Fe,Me,Oe,Ue=(0,v.Z)(b.Z)(Ce||(Ce=(0,a.Z)(["\n  padding: 48px;\n  border-radius: 48px;\n"]))),Je=(0,f.ZP)(x.Z).withConfig({componentId:"sc-1g4towc-0"})(["width:100%;"]),Le=(0,f.ZP)(ne.Z).withConfig({componentId:"sc-1g4towc-1"})(["width:100%;"]),$e=f.ZP.h1.withConfig({componentId:"sc-1g4towc-2"})(["margin:0;"]),Ye=f.ZP.p.withConfig({componentId:"sc-1g4towc-3"})(["margin:0;color:grey;"]),He=(0,f.ZP)(oe.Z).withConfig({componentId:"sc-1g4towc-4"})(["width:100%;"]),Ve=(0,v.Z)(g.Z)(ke||(ke=(0,a.Z)(["\n  color: rgb(255, 138, 0);\n"]))),Ge=f.ZP.h3.withConfig({componentId:"sc-1g4towc-5"})(["margin:0;"]);function Ke(e){var n=(0,m.useState)({pendingReview:[],underReview:[],errors:[],approved:[],declined:[]}),t=(0,p.Z)(n,2),r=t[0],o=t[1],i=(0,m.useState)(!1),s=(0,p.Z)(i,2),a=s[0],f=s[1],x=(0,m.useState)(!1),Z=(0,p.Z)(x,2),g=Z[0],j=Z[1],w=(0,m.useState)(null),b=(0,p.Z)(w,2),v=b[0],C=b[1],k=(0,m.useState)(),y=(0,p.Z)(k,2),q=y[0],I=y[1],S=(0,m.useState)(!1),P=(0,p.Z)(S,2),E=P[0],N=P[1],R=(0,m.useState)([]),T=(0,p.Z)(R,2),A=T[0],D=T[1],z=(0,m.useState)(!1),B=(0,p.Z)(z,2),F=B[0],M=B[1],O=(0,m.useState)({firstName:"",lastName:""}),U=(0,p.Z)(O,2),J=U[0],L=U[1];(0,m.useEffect)((function(){var n=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(){var t,r,i;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return j(!0),n.prev=1,t="".concat("https://plexfinance-backend-production.up.railway.app","/requests/"),n.next=5,fetch(t,{method:"GET",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer"});case 5:if(401!==(r=n.sent).status&&422!==r.status||e.removeToken(),r.ok){n.next=11;break}return console.error(r),I({errorCode:r.status,errorMessage:r.statusText}),n.abrupt("return");case 11:return n.next=13,r.json();case 13:i=n.sent,N(i.treasurer),D(i.teams),L({firstName:i.firstName,lastName:i.lastName}),delete i.treasurer,delete i.teams,delete i.firstName,delete i.lastName,o(i),j(!1),n.next=30;break;case 25:return n.prev=25,n.t0=n.catch(1),I({errorMessage:n.t0.toString()}),console.error(n.t0),n.abrupt("return");case 30:case"end":return n.stop()}}),n,null,[[1,25]])})));return function(){return n.apply(this,arguments)}}();n()}),[e,e.token]);var $=function(){f(!1)},H=function(e,n){C(e),M(!E||n||!e),f(!0)};return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(h.ql,{children:[(0,_.jsx)("title",{children:"Reimbursements"}),(0,_.jsx)("meta",{name:"description",content:"Your finance dashboard"})]}),q?(0,_.jsx)(Y.C,{open:!q,error:q}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Qe,{open:a,onClose:$,children:(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(Be,{request:v,teams:A,setRequests:o,onClose:$,onSubmit:function(e,n){o(n?function(n){return(0,u.Z)((0,u.Z)({},n),{},{pendingReview:(0,c.Z)(n.pendingReview.filter((function(n){return n._id!==e._id}))),errors:(0,c.Z)(n.errors.filter((function(n){return n._id!==e._id})))})}:function(n){return(0,u.Z)((0,u.Z)({},n),{},{pendingReview:[e].concat((0,c.Z)(n.pendingReview.filter((function(n){return n._id!==e._id})))),errors:(0,c.Z)(n.errors.filter((function(n){return n._id!==e._id})))})})},onError:function(e){e.status?I({errorCode:e.status,errorMessage:e.statusText}):I({errorMessage:e.statusText})},token:e.token,canEdit:F,userName:J})})}),g&&(0,_.jsx)(Xe,{}),(0,_.jsx)(We,{justifyContent:"space-between",children:(0,_.jsx)(ve,{requests:g?null:r,onEdit:H,onRequest:function(){H(null,!1)},isTreasurer:E,token:e.token,userName:J})})]})]})}var We=(0,f.ZP)(x.Z)(Fe||(Fe=(0,a.Z)(["\n  width: 100%;\n  height: 100%;\n  padding-top: 24px;\n  padding-left: 48px;\n  padding-right: 48px;\n"]))),Qe=(0,f.ZP)(Z.Z)(Me||(Me=(0,a.Z)(["\n  width: 50%;\n  min-width: 500px;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n  padding: 64px;\n  overflow: auto;\n  -ms-overflow-style: none; /* IE and Edge */\n  scrollbar-width: none;\n  ::-webkit-scrollbar {\n    display: none;\n  }\n"]))),Xe=(0,v.Z)(g.Z)(Oe||(Oe=(0,a.Z)(["\n  color: rgb(255, 138, 0);\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n"])))}}]);