"use strict";(self.webpackChunkplexfinance=self.webpackChunkplexfinance||[]).push([[211],{6465:function(e,r,n){n.d(r,{A:function(){return c}});var t=n(94469),s=n(33604),i=n(4117),a=n(69099),o=(n(47313),n(46417));function c(e){return(0,o.jsxs)(t.Z,{onClose:e.onClose,open:e.open,PaperProps:{style:{borderRadius:"24px",padding:"24px"}},children:[(0,o.jsxs)(s.Z,{children:["Are you sure you want to delete this ",e.item,"?"]}),(0,o.jsxs)(i.Z,{children:[(0,o.jsx)(a.Z,{onClick:e.onClose,children:"Cancel"}),(0,o.jsx)(a.Z,{onClick:e.onDelete,variant:"contained",children:"Delete"})]})]})}},95785:function(e,r,n){n.d(r,{C:function(){return x}});var t,s=n(30168),i=n(53115),a=n(42832),o=n(47131),c=n(70501),l=n(10387),d=(n(47313),n(96694)),u=n(32094),h=n.p+"static/media/error.062a662df0ebdd9a7227.png",p=n(46417);function x(e){return(0,p.jsx)(j,{open:e.open,children:(0,p.jsx)(f,{children:(0,p.jsxs)(a.Z,{spacing:2,children:[(0,p.jsxs)(a.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,p.jsxs)(Z,{children:["Error",e.error.errorCode&&" ".concat(e.error.errorCode),":"," ",e.error.errorMessage]}),(0,p.jsx)(o.Z,{onClick:function(){window.location.reload()},children:(0,p.jsx)(u.Z,{})})]}),(0,p.jsxs)(m,{children:["Try refreshing the page and contact"," ",(0,p.jsx)("a",{href:"mailto:shamith09@berkeley.edu?subject=[Plexfinance Error]",children:"shamith09@berkeley.edu"})," ","if the issue persists."]}),(0,p.jsx)("img",{src:h,alt:"error"})]})})})}var f=(0,d.Z)(c.Z)(t||(t=(0,s.Z)(["\n  padding: 48px;\n  border-radius: 48px;\n"]))),Z=i.ZP.h1.withConfig({componentId:"sc-khwwpk-0"})(["margin:0px;"]),m=i.ZP.p.withConfig({componentId:"sc-khwwpk-1"})(["margin:0px;"]),j=(0,i.ZP)(l.Z).withConfig({componentId:"sc-khwwpk-2"})(["width:50%;min-width:500px;height:100%;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;padding:64px;"])},86095:function(e,r,n){n.r(r),n.d(r,{AttendancePage:function(){return R}});var t=n(30168),s=n(93433),i=n(37762),a=n(74165),o=n(1413),c=n(15861),l=n(29439),d=n(53115),u=n(95785),h=n(47313),p=n(65964),x=n(10658),f=n.n(x),Z=n(83814),m=n(49124),j=n(43394),g=n(42832),k=n(31427),b=n(69099),v=n(41727),y=n(47131),w=n(51629),C=n(66835),S=n(23477),T=n(24076),M=n(67478),A=n(57861),D=n(70501),P=n(85281),z=n(96694),E=n(57829),Y=n(65033),I=n(61113),N=n(29428),_=n(3665),B=n(6465),O=n(35192),L=n(46417),J=3;function q(e){var r=e.user,n=e.date,t=e.setLoading,s=e.setError,i=(0,h.useState)(!1),o=(0,l.Z)(i,2),d=o[0],u=o[1],p=(0,h.useState)(!1),x=(0,l.Z)(p,2),Z=x[0],m=x[1],j=function(){var r=(0,c.Z)((0,a.Z)().mark((function r(n){var i,o;return(0,a.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return m(!1),t(!0),i="".concat("https://plexfinance-backend-production.up.railway.app","/attendance/"),r.prev=3,r.next=6,fetch(i,{method:"DELETE",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({_id:n})});case 6:if(o=r.sent,t(!1),e.onDelete(n),401!==o.status&&422!==o.status){r.next=14;break}return e.removeToken(),r.abrupt("return");case 14:o.ok||(s({errorCode:o.status,errorMessage:o.statusText}),console.error(o));case 15:r.next=21;break;case 17:r.prev=17,r.t0=r.catch(3),s({errorMessage:r.t0.toString()}),console.error(r.t0);case 21:case"end":return r.stop()}}),r,null,[[3,17]])})));return function(e){return r.apply(this,arguments)}}(),k=function(){var n=(0,c.Z)((0,a.Z)().mark((function n(i,o){var c,l;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c="".concat("https://plexfinance-backend-production.up.railway.app","/attendance/"),t(!0),n.prev=2,n.next=5,fetch(c,{method:"DELETE",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({_id:r._id,date:o,type:i})});case 5:if(l=n.sent,t(!1),"tardy"===i?(delete r.tardies[r.tardies.findIndex((function(e){return e.isSame(o,"day")}))],r.tardies=r.tardies.filter((function(e){return void 0!==e}))):"absent"===i?(delete r.absences[r.absences.findIndex((function(e){return e.isSame(o,"day")}))],r.absences=r.absences.filter((function(e){return void 0!==e}))):(delete r.strikes[r.strikes.findIndex((function(e){return e.isSame(o,"day")}))],r.strikes=r.strikes.filter((function(e){return void 0!==e}))),401!==l.status&&422!==l.status){n.next=13;break}return e.removeToken(),n.abrupt("return");case 13:l.ok||(s({errorCode:l.status,errorMessage:l.statusText}),console.error(l));case 14:n.next=20;break;case 16:n.prev=16,n.t0=n.catch(2),s({errorMessage:n.t0.toString()}),console.error(n.t0);case 20:case"end":return n.stop()}}),n,null,[[2,16]])})));return function(e,r){return n.apply(this,arguments)}}(),v=function(){var i=(0,c.Z)((0,a.Z)().mark((function i(o){var c,l;return(0,a.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c="".concat("https://plexfinance-backend-production.up.railway.app","/attendance/"),t(!0),i.prev=2,i.next=5,fetch(c,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({_id:r._id,date:n,type:o})});case 5:if(l=i.sent,t(!1),"tardy"===o?r.tardies.push(n):"absent"===o?r.absences.push(n):r.strikes.push(n),401!==l.status&&422!==l.status){i.next=13;break}return e.removeToken(),i.abrupt("return");case 13:l.ok||(s({errorCode:l.status,errorMessage:l.statusText}),console.error(l));case 14:i.next=20;break;case 16:i.prev=16,i.t0=i.catch(2),s({errorMessage:i.t0.toString()}),console.error(i.t0);case 20:case"end":return i.stop()}}),i,null,[[2,16]])})));return function(e){return i.apply(this,arguments)}}();return(0,L.jsxs)(L.Fragment,{children:[Z&&(0,L.jsx)(B.A,{open:Z,item:"user",onClose:function(){return m(!1)},onDelete:function(){return j(r._id)}}),(0,L.jsxs)(T.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,L.jsx)(M.Z,{children:(0,L.jsx)(y.Z,{size:"small",onClick:function(){return u(!d)},style:{width:"10px",backgroundColor:"transparent"},disabled:!d&&r.absences.length+r.tardies.length===0,children:d?(0,L.jsx)(_.Z,{}):(0,L.jsx)(N.Z,{})})}),(0,L.jsx)(M.Z,{component:"th",scope:"row",children:r.registered?"".concat(r.firstName," ").concat(r.lastName):r.email}),(0,L.jsx)(M.Z,{align:"right",children:(0,L.jsx)(b.Z,{size:"small",onClick:function(){v("tardy")},children:r.tardies.length})}),(0,L.jsx)(M.Z,{align:"right",children:(0,L.jsx)(b.Z,{size:"small",onClick:function(){v("absent")},children:r.absences.length})}),(0,L.jsx)(M.Z,{align:"right",children:(0,L.jsx)(b.Z,{size:"small",onClick:function(){v("strike")},children:r.strikes.length})}),(0,L.jsx)(M.Z,{align:"center",children:(0,L.jsx)(y.Z,{size:"small",onClick:function(){return m(!0)},children:(0,L.jsx)(O.Z,{})})})]},r._id),(0,L.jsx)(T.Z,{children:(0,L.jsx)(M.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:(0,L.jsx)(Y.Z,{in:r.tardies.length+r.absences.length+r.strikes.length>0&&d,timeout:"auto",unmountOnExit:!0,children:(0,L.jsxs)(E.Z,{sx:{margin:1},children:[(0,L.jsxs)(g.Z,{direction:"row",justifyContent:"space-between",style:{width:"100%"},children:[(0,L.jsx)(I.Z,{variant:"subtitle1",gutterBottom:!0,component:"div",children:"History"}),(0,L.jsxs)(I.Z,{variant:"subtitle1",gutterBottom:!0,component:"div",children:["Slip meetings left:"," ",Math.max(0,J-r.tardies.length-r.absences.length-r.strikes.length)]})]}),(0,L.jsxs)(C.Z,{size:"small","aria-label":"purchases",children:[(0,L.jsx)(S.Z,{children:(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{children:"Date"}),(0,L.jsx)(M.Z,{children:"Tardy/Absence/Strike?"}),(0,L.jsx)(M.Z,{children:"Delete"})]})}),(0,L.jsx)(A.Z,{children:r.tardies.map((function(e){return(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{component:"th",scope:"row",children:f()(e).format("MM/DD/YYYY")}),(0,L.jsx)(M.Z,{children:"Tardy"}),(0,L.jsx)(M.Z,{children:(0,L.jsx)(y.Z,{onClick:function(){return k("tardy",e)},children:(0,L.jsx)(O.Z,{})})})]},e.toString())})).concat(r.absences.map((function(e){return(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{component:"th",scope:"row",children:f()(e).format("MM/DD/YYYY")}),(0,L.jsx)(M.Z,{children:"Absence"}),(0,L.jsx)(M.Z,{children:(0,L.jsx)(y.Z,{onClick:function(){return k("absent",e)},children:(0,L.jsx)(O.Z,{})})})]},e.toString())}))).concat(r.strikes.map((function(e){return(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{component:"th",scope:"row",children:f()(e).format("MM/DD/YYYY")}),(0,L.jsx)(M.Z,{children:"Strike"}),(0,L.jsx)(M.Z,{children:(0,L.jsx)(y.Z,{onClick:function(){return k("strike",e)},children:(0,L.jsx)(O.Z,{})})})]},e.toString())}))).sort()})]})]})})})})]})}var F,G,H=n(5211);function R(e){var r=(0,h.useState)(!1),n=(0,l.Z)(r,2),t=n[0],d=n[1],x=(0,h.useState)(),D=(0,l.Z)(x,2),P=D[0],z=D[1],E=(0,h.useState)([]),Y=(0,l.Z)(E,2),I=Y[0],N=Y[1],_=(0,h.useState)(f()()),B=(0,l.Z)(_,2),O=B[0],J=B[1],F=(0,h.useState)(""),G=(0,l.Z)(F,2),R=G[0],K=G[1],Q=(0,h.useState)(!1),V=(0,l.Z)(Q,2),X=V[0],ee=V[1];(0,h.useEffect)((function(){var r=function(){var r=(0,c.Z)((0,a.Z)().mark((function r(){var n,t,s;return(0,a.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return d(!0),n="".concat("https://plexfinance-backend-production.up.railway.app","/attendance/"),r.prev=2,r.next=5,fetch(n,{method:"GET",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer"});case 5:if(t=r.sent,d(!1),401!==t.status&&422!==t.status){r.next=12;break}return e.removeToken(),r.abrupt("return");case 12:t.ok||(z({errorCode:t.status,errorMessage:t.statusText}),console.error(t));case 13:return r.next=15,t.json();case 15:s=r.sent,N(s.users.map((function(e){return(0,o.Z)((0,o.Z)({},e),{},{tardies:e.tardies.map((function(e){return f()(e)})),absences:e.absences.map((function(e){return f()(e)})),strikes:e.strikes.map((function(e){return f()(e)}))})}))),r.next=23;break;case 19:r.prev=19,r.t0=r.catch(2),z({errorMessage:r.t0.toString()}),console.error(r.t0);case 23:case"end":return r.stop()}}),r,null,[[2,19]])})));return function(){return r.apply(this,arguments)}}();r()}),[e,e.token]);var re=function(e){N(I.filter((function(r){return r._id!==e})))},ne=function(){var r=(0,c.Z)((0,a.Z)().mark((function r(){var n,t,o,c,l,u,h;return(0,a.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:d(!0),n=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,t=(0,i.Z)(R.split(", ")),r.prev=3,t.s();case 5:if((o=t.n()).done){r.next=13;break}if(c=o.value,n.test(c)){r.next=11;break}return ee(!0),d(!1),r.abrupt("return");case 11:r.next=5;break;case 13:r.next=18;break;case 15:r.prev=15,r.t0=r.catch(3),t.e(r.t0);case 18:return r.prev=18,t.f(),r.finish(18);case 21:return l="".concat("https://plexfinance-backend-production.up.railway.app","/profile/"),r.prev=22,r.next=25,fetch(l,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({emails:R.split(", ")})});case 25:if(401!==(u=r.sent).status&&422!==u.status){r.next=31;break}return e.removeToken(),r.abrupt("return");case 31:u.ok||(z({errorCode:u.status,errorMessage:u.statusText}),console.error(u));case 32:return r.next=34,u.json();case 34:h=r.sent,N([].concat((0,s.Z)(I),(0,s.Z)(h.users))),d(!1),K(""),r.next=44;break;case 40:r.prev=40,r.t1=r.catch(22),z({errorMessage:r.t1.toString()}),console.error(r.t1);case 44:case"end":return r.stop()}}),r,null,[[3,15,18,21],[22,40]])})));return function(){return r.apply(this,arguments)}}();return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(p.ql,{children:[(0,L.jsx)("title",{children:"Attendance"}),(0,L.jsx)("meta",{name:"description",content:"Take attendance here"})]}),P&&(0,L.jsx)(u.C,{open:!!P,error:P}),(0,L.jsx)($,{children:(0,L.jsxs)(g.Z,{spacing:4,children:[(0,L.jsxs)(j._,{dateAdapter:m.y,children:[(0,L.jsxs)(U,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,L.jsx)(Z.M,{label:"GM Date",value:O,onChange:function(e){J(e)},renderInput:function(e){return(0,L.jsx)(k.Z,(0,o.Z)({},e))}}),t?(0,L.jsx)(W,{}):(0,L.jsx)(b.Z,{onClick:function(){console.log({tardy:I.filter((function(e){return e.tardies.filter((function(e){return e.isSame(O,"day")})).length>0})).map((function(e){return e.registered?"".concat(e.firstName," ").concat(e.lastName):e.email})),absent:I.filter((function(e){return e.absences.filter((function(e){return e.isSame(O,"day")})).length>0})).map((function(e){return e.registered?"".concat(e.firstName," ").concat(e.lastName):e.email}))})},variant:"contained",children:"Log Report"})]}),(0,L.jsx)(k.Z,{label:"Add User(s)",helperText:"Enter emails as a comma-separated list with spaces.",value:R,onChange:function(e){return K(e.target.value)},error:X,fullWidth:!0,InputProps:{endAdornment:(0,L.jsx)(v.Z,{position:"end",children:(0,L.jsx)(y.Z,{onClick:ne,edge:"end",children:(0,L.jsx)(H.Z,{})})})}})]}),O&&(0,L.jsx)(w.Z,{children:(0,L.jsxs)(C.Z,{stickyHeader:!0,children:[(0,L.jsx)(S.Z,{children:(0,L.jsxs)(T.Z,{children:[(0,L.jsx)(M.Z,{}),(0,L.jsx)(M.Z,{children:"Name"}),(0,L.jsx)(M.Z,{align:"right",children:"Tardies"}),(0,L.jsx)(M.Z,{align:"right",children:"Absences"}),(0,L.jsx)(M.Z,{align:"right",children:"Strikes"}),(0,L.jsx)(M.Z,{align:"center",children:"Delete"})]})}),(0,L.jsx)(A.Z,{children:I.map((function(r){return(0,L.jsx)(q,{user:r,date:O,token:e.token,removeToken:e.removeToken,setLoading:d,setError:z,onDelete:re},r._id)}))})]})})]})})]})}var $=(0,z.Z)(D.Z)(F||(F=(0,t.Z)(["\n  min-height: 95%;\n  width: 60%;\n  min-width: 500px;\n  margin: auto;\n  padding: 64px;\n  border-radius: 48px;\n"]))),U=(0,d.ZP)(g.Z).withConfig({componentId:"sc-1c0zhqi-0"})(["width:100%;"]),W=(0,z.Z)(P.Z)(G||(G=(0,t.Z)(["\n  color: rgb(255, 138, 0);\n"])))}}]);